@(plats: List[Plat], platProduits: List[PlatProduit],stockRestos: List[StockResto], quantitePlat: Int,produits: List[Produit])
<!DOCTYPE html>
<html>
	<head>
		<title>Liste des plats</title>
	</head>
	
	<body>

		@views.html.cuisinier_header()
		@if(plats != null){
			
			<div class="container">
				
				<div id="plats" class="form-group">
				</div>
				<br><br><br>
				<div class="row">
						<a href="@routes.Application.formulairePlatBis()"><input type="submit" value="Valider"  class="btn btn-success btn btn-success col-md-2 col-md-offset-4" /></a><br>
				</div>
			</div>
			
			<script>
			
					var platCompared = 0;
					var stockRestoUnite = "", stockRestoQuantite = 0, stockRestoPid = 0,stockRestoAlerte = 0, stockCritique = 0;
					var platProduitUnite = "", platProduitQuantite = 0, platProduitPid = 0;
					var nomProduit = "";
					var alerte = "";
					var alerteTableau = "";
					var message = "";
					
					@if(quantitePlat != 0){
						console.log("alajazam");
						@if(stockRestos != null){
							@if(platProduits != null){
								@for(platProduit <- platProduits){
									platProduitUnite = platProduit.unite;
									platProduitQuantite = platProduit.quantie;
									platProduitPid = platProduit.produit.pid;
									
									@for(stockResto <- stockRestos){
										
										stockRestoUnite = stockResto.unite;
										stockRestoQuantite = stockResto.quantie;
										stockRestoPid = stockResto.produit.pid;
										stockRestoAlerte = stockResto.stockAlerte;
										stockRestoCritique = stockResto.stockMin
										if(platProduitPid == stockRestoPid){
											
											@for(produit <- produits){
												
												if(platProduitPid == produit.pid){
													
													if(platProduitQuantite > stockRestoQuantite){
														alerte = "impossible";
														nomProduit = produit.productName;
														alerteTableau.push(alerte,nomProduit);
													}else{
														if(platProduitQuantite < stockRestoAlerte){
															alerte = "alerte";
															nomProduit = produit.productName;
															alerteTableau.push(alerte,nomProduit);
															if(platProduitQuantite < stockRestoCritique){
																alerte = "critique"
																nomProduit = produit.productName;
																alerteTableau.push(alerte,nomProduit);
															}
														}else{
															alerte = "ok";
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
					
					for(var i = 0; i < alerteTableau.length; i = i +2){
						if(alerteTableau[i] == "impossible"){
							message += "Impossible de préparer le plat car il n'y a pas assez de" + alerteTableau[i+1];
							if(alerteTableau[i] == "alerte" || alerteTableau[i] == "critique"){
								message += "Vous pouvez préparer ce plat en utilisant les stocks" + alerte + "de l'ingrédient" + alerteTableau[i+1];
							}		
						}	
					}
					
					$('<h1 />').text(message)
								.appendTo($(".container"));
		
			
					
				var line = 0, quantitePlatBis = "",classInput = "", indice = "";
				
				@for(plat <- plats){
					
					line ++;
					
					$('<div />',{
									id: "row" + line,
									class: "row form-group"
								}).appendTo($("#plats"));
					
					for(var i = 0; i < 3; i++){
						
						$('<div />',{
							id: "col" + i + line,
							class: "col-md-4"
						}).appendTo($("#row" + line));
						
						if(i == 0){
							
							$('<h4 />', {
								for: "plat" + line,
								id : 'label' + line,	
							}).html("@plat.platName")
							  .appendTo($("#col" + i + line));
							
						}else if(i == 1){		
							
							$('<input />',{
												type: "text",
												name: "quantitePlat" + line,
												id: "quantitePlat" + line
										  }).appendTo($("#col" + i + line));
							
						}else{
							
							/*$('<a />',{
								href: "",
								id: "href" + line
						  	}).appendTo($("#col" + i + line));	*/	
				
							$('<input />',{
									type: "button",
									value: "Verifier",
									class: "btn btn-warning" + " " + line
							}).click(function(){
							    quantitePlatBis = $("#quantitePlat").val();
								classInput = this.class;
								console.log(classInput);
								indice = classInput.split(" ");
								//console.log(classInput);
								//$("#href" + indice[2]).attr("href","@routes.Application.verificationPlat(plat.plid,"+quantitePlatBis+")");
								
							}).appendTo($("#col" + i + line));
				
						}
						
					}
				}
		
		</script>
			
		}else{
			<h1>Il y a un probleme.</h1>
		}
		
		@views.html.footer()
	
	</body>
	
</html>